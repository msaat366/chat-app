(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{316:function(e,t,n){},367:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n(33),r=n.n(a),s=n(60),i=n(13),o=(n(200),n(15)),l=n.n(o),j=n(18),u=n(23),d=n(376),b=n(380),h=n(381),O=n(382),f=n(383),m=n(378),x=n(94),p=n(93),v=(n(202),n(204),n(368),u.a.initializeApp({apiKey:"AIzaSyBJ8BIozm8m6Mh625DJyLDjKHrZi--120g",authDomain:"chat-app-3d4b8.firebaseapp.com",projectId:"chat-app-3d4b8",storageBucket:"chat-app-3d4b8.appspot.com",messagingSenderId:"874785747372",appId:"1:874785747372:web:c2a6c234965321bbc8ca09",measurementId:"G-W0MC2PE2VR"})),g=v.auth(),k=v.database("https://chat-app-3d4b8-default-rtdb.asia-southeast1.firebasedatabase.app"),w=v.storage(),C=n(3),N=function(){var e=function(){var e=Object(j.a)(l.a.mark((function e(t){var n,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.signInWithPopup(t);case 3:if(n=e.sent,c=n.additionalUserInfo,a=n.user,!c.isNewUser){e.next=9;break}return e.next=9,k.ref("/profiles/".concat(a.uid)).set({name:a.displayName,createdAt:u.a.database.ServerValue.TIMESTAMP});case 9:d.a.success("Signed in ",4e3),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),d.a.info(e.t0.message,4e3);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(C.jsx)(b.a,{children:Object(C.jsx)(h.a,{className:"mt-page",children:Object(C.jsx)(O.a,{children:Object(C.jsx)(f.a,{xs:24,md:12,mdOffset:6,lg:12,children:Object(C.jsxs)(m.a,{children:[Object(C.jsxs)("div",{className:"text-center",children:[Object(C.jsx)("h2",{children:"Welcome to Chat"}),Object(C.jsx)("p",{children:"Progressive chat platform for Goodness Gracious"})]}),Object(C.jsxs)("div",{className:"mt-3",children:[Object(C.jsxs)(x.a,{block:!0,color:"blue",onClick:function(){e(new u.a.auth.FacebookAuthProvider)},children:[Object(C.jsx)(p.a,{icon:"facebook"})," Continue With Facebook"]}),Object(C.jsxs)(x.a,{block:!0,color:"green",onClick:function(){e(new u.a.auth.GoogleAuthProvider)},children:[Object(C.jsx)(p.a,{icon:"google"})," Continue With Google"]})]})]})})})})})},y=(n(316),n(14)),S=n(390),A=n(42),E=n(16),I=n(384),M=n(371),P=n(385),D=n(372),T=n(386),L=n(377);function B(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(c.useState)(e),n=Object(y.a)(t,2),a=n[0],r=n[1],s=Object(c.useCallback)((function(){r(!0)}),[]),i=Object(c.useCallback)((function(){r(!1)}),[]);return{isOpen:a,open:s,close:i}}var H=function(e){var t=Object(c.useState)((function(){return window.matchMedia(e).matches})),n=Object(y.a)(t,2),a=n[0],r=n[1];return Object(c.useEffect)((function(){var t=window.matchMedia(e);r(t.matches);var n=function(e){return r(e.matches)};return t.addEventListener("change",n),function(){return t.removeEventListener("change",n)}}),[e]),a};var U=I.a.Types.StringType,F=I.a.Model({name:U().isRequired("Chat name is required"),description:U().isRequired("Description is required")}),R={name:"",description:""},z=function(){var e=B(),t=e.isOpen,n=e.open,a=e.close,r=Object(c.useState)(R),s=Object(y.a)(r,2),i=s[0],o=s[1],b=Object(c.useState)(!1),h=Object(y.a)(b,2),O=h[0],f=h[1],m=Object(c.useRef)(),v=Object(c.useCallback)((function(e){o(e)}),[]),w=function(){var e=Object(j.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m.current.check()){e.next=2;break}return e.abrupt("return");case 2:return f(!0),t=Object(E.a)(Object(E.a)({},i),{},{createdAt:u.a.database.ServerValue.TIMESTAMP,admins:Object(A.a)({},g.currentUser.uid,!0)}),e.prev=4,e.next=7,k.ref("rooms").push(t);case 7:d.a.info("".concat(i.name," has been created"),4e3),f(!1),o(R),a(),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(4),f(!1),d.a.error(e.t0.message,4e3);case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(){return e.apply(this,arguments)}}();return Object(C.jsxs)("div",{className:"mt-1",children:[Object(C.jsxs)(x.a,{block:!0,color:"green",onClick:n,children:[Object(C.jsx)(p.a,{icon:"creative"})," Create new Chat room"]}),Object(C.jsxs)(M.a,{show:t,onHide:a,children:[Object(C.jsx)(M.a.Header,{children:Object(C.jsx)(M.a.Title,{children:"New Chat Room"})}),Object(C.jsx)(M.a.Body,{children:Object(C.jsxs)(P.a,{fluid:!0,onChange:v,formValue:i,model:F,ref:m,children:[Object(C.jsxs)(D.a,{children:[Object(C.jsx)(T.a,{children:"Room name"}),Object(C.jsx)(L.a,{name:"name",placeholder:"Enter Chat room name..."})]}),Object(C.jsxs)(D.a,{children:[Object(C.jsx)(T.a,{children:"Description"}),Object(C.jsx)(L.a,{rows:5,name:"description",placeholder:"Enter the description...",componentClass:"textarea"})]})]})}),Object(C.jsx)(M.a.Footer,{children:Object(C.jsx)(x.a,{block:!0,appearance:"primary",onClick:w,disabled:O,children:"Create new chat room"})})]})]})},V=n(379),W={state:"offline",last_changed:u.a.database.ServerValue.TIMESTAMP},G={state:"online",last_changed:u.a.database.ServerValue.TIMESTAMP},q=Object(c.createContext)(),J=function(e){var t=e.children,n=Object(c.useState)(null),a=Object(y.a)(n,2),r=a[0],s=a[1],i=Object(c.useState)(!0),o=Object(y.a)(i,2),l=o[0],j=o[1];return Object(c.useEffect)((function(){var e,t,n=g.onAuthStateChanged((function(n){n?(e=k.ref("/profiles/".concat(n.uid)),t=k.ref("/status/".concat(n.uid)),e.on("value",(function(e){var t=e.val(),c={name:t.name,createdAt:t.createdAt,avatar:t.avatar,uid:n.uid,email:n.email};s(c),j(!1)})),k.ref(".info/connected").on("value",(function(e){!1!==!!e.val()&&t.onDisconnect().set(W).then((function(){t.set(G)}))}))):(e&&e.off(),t&&t.off(),k.ref(".info/connected").off(),s(null),j(!1))}));return function(){n(),k.ref(".info/connected").off(),t&&t.off(),e&&e.off()}}),[]),Object(C.jsx)(q.Provider,{value:{isLoading:l,profile:r},children:t})},K=function(){return Object(c.useContext)(q)};function _(e){var t=e.toUpperCase().split(" ");return t.length>1?t[0][0]+t[1][0]:t[0][0]}function Y(e){return e?Object.keys(e).map((function(t){return Object(E.a)(Object(E.a)({},e[t]),{},{id:t})})):[]}function Z(e,t,n,c){return Q.apply(this,arguments)}function Q(){return(Q=Object(j.a)(l.a.mark((function e(t,n,c,a){var r,s,i,o,j,u,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r={})["/profiles/".concat(t,"/").concat(n)]=c,s=a.ref("/messages").orderByChild("author/uid").equalTo(t).once("value"),i=a.ref("/rooms").orderByChild("lastMessage/author/uid").equalTo(t).once("value"),e.next=6,Promise.all([s,i]);case 6:return o=e.sent,j=Object(y.a)(o,2),u=j[0],d=j[1],u.forEach((function(e){r["/messages/".concat(e.key,"/author/").concat(n)]=c})),d.forEach((function(e){r["/rooms/".concat(e.key,"/lastMessage/author/").concat(n)]=c})),e.abrupt("return",r);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var X=n(188),$=n.n(X),ee=n(37),te=n(387),ne=["name"],ce=function(e){var t=e.name,n=Object(ee.a)(e,ne);return Object(C.jsx)(te.a,Object(E.a)(Object(E.a)({circle:!0},n),{},{children:_(t)}))},ae=["image/png","image/jpeg","image/pjpeg"],re=function(e){return new Promise((function(t,n){e.toBlob((function(e){e?t(e):n(new Error("File Parse Error"))}))}))},se=function(){var e=B(),t=e.isOpen,n=e.open,a=e.close,r=K().profile,s=Object(c.useState)(!1),i=Object(y.a)(s,2),o=i[0],u=i[1],b=Object(c.useState)(null),h=Object(y.a)(b,2),O=h[0],f=h[1],m=Object(c.useRef)(),p=function(){var e=Object(j.a)(l.a.mark((function e(){var t,n,c,s,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.current.getImageScaledToCanvas(),u(!0),e.prev=2,e.next=5,re(t);case 5:return n=e.sent,c=w.ref("/profiles/".concat(r.uid)).child("avatar"),e.next=9,c.put(n,{cacheControl:"public , max-age = ".concat(259200)});case 9:return s=e.sent,e.next=12,s.ref.getDownloadURL();case 12:return i=e.sent,e.next=15,Z(r.uid,"avatar",i,k);case 15:return o=e.sent,e.next=18,k.ref().update(o);case 18:u(!1),a(),d.a.info("Avatar has been uploaded",4e3),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(2),u(!1),d.a.error(e.t0.message,3e3);case 27:case"end":return e.stop()}}),e,null,[[2,23]])})));return function(){return e.apply(this,arguments)}}();return Object(C.jsxs)("div",{className:"mt-3 text-center",children:[Object(C.jsx)(ce,{src:r.avatar,name:r.name,className:"width-200 height-200 img-fullsize font-huge"}),Object(C.jsxs)("label",{htmlFor:"avatar-upload",className:"d-block cursor-pointer padded",children:["Select New Avatar",Object(C.jsx)("input",{type:"file",id:"avatar-upload",className:"d-none",accept:".png, .jpeg, .jpg",onChange:function(e){var t=e.target.files;if(1===t.length){var c=t[0];!function(e){return ae.includes(e.type)}(c)?d.a.warning("Wrong file type ".concat(c.type),4e3):(f(c),n())}}})]}),Object(C.jsxs)(M.a,{show:t,onHide:a,children:[Object(C.jsx)(M.a.Header,{children:Object(C.jsx)(M.a.Title,{children:"Adjust and Upload new avatar"})}),Object(C.jsx)(M.a.Body,{children:Object(C.jsx)("div",{className:"d-flex justify-content-center align-items-center h-100",children:O&&Object(C.jsx)($.a,{ref:m,image:O,width:200,height:200,border:10,borderRadius:100,rotate:0})})}),Object(C.jsx)(M.a.Footer,{children:Object(C.jsx)(x.a,{block:!0,appearance:"ghost",onClick:p,disabled:o,children:"Upload New Avatar"})})]})]})},ie=n(374),oe=n(195),le=["initialValue","onSave","label","placeholder","emptyMsg","wrapperClassName"],je=function(e){var t=e.initialValue,n=e.onSave,a=e.label,r=void 0===a?null:a,s=e.placeholder,i=void 0===s?"Write your Value":s,o=e.emptyMsg,u=void 0===o?"Input is empty":o,b=e.wrapperClassName,h=void 0===b?"":b,O=Object(ee.a)(e,le),f=Object(c.useState)(t),m=Object(y.a)(f,2),x=m[0],v=m[1],g=Object(c.useState)(!1),k=Object(y.a)(g,2),w=k[0],N=k[1],S=Object(c.useCallback)((function(e){v(e)}),[]),A=Object(c.useCallback)((function(){N((function(e){return!e}))}),[]),I=function(){var e=Object(j.a)(l.a.mark((function e(){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===(c=x.trim())&&d.a.info(u,4e3),c===t){e.next=5;break}return e.next=5,n(c);case 5:N(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(C.jsxs)("div",{className:h,children:[r,Object(C.jsxs)(ie.a,{children:[Object(C.jsx)(oe.a,Object(E.a)(Object(E.a)({},O),{},{disabled:!w,placeholder:i,value:x,onChange:S})),Object(C.jsx)(ie.a.Button,{onClick:A,children:Object(C.jsx)(p.a,{icon:w?"close":"edit2"})}),w&&Object(C.jsx)(ie.a.Button,{onClick:I,children:Object(C.jsx)(p.a,{icon:"check"})})]})]})},ue=n(388),de=function(){var e=Object(c.useState)({"google.com":g.currentUser.providerData.some((function(e){return"google.com"===e.providerId})),"facebook.com":g.currentUser.providerData.some((function(e){return"facebook.com"===e.providerId}))}),t=Object(y.a)(e,2),n=t[0],a=t[1],r=function(e,t){a((function(n){return Object(E.a)(Object(E.a)({},n),{},Object(A.a)({},e,t))}))},s=function(){var e=Object(j.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,1!==g.currentUser.providerData.length){e.next=3;break}throw new Error("You cannot disconnect from ".concat(t));case 3:return e.next=5,g.currentUser.unlink(t);case 5:r(t,!1),d.a.info("Disconnected from ".concat(t),3e3),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),d.a.error(e.t0.message,4e3);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),i=function(){var e=Object(j.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.currentUser.linkWithPopup(t);case 3:d.a.info("Linked to ".concat(t.providerId),4e3),r(t.providerId,!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),d.a.error(e.t0.message,4e3);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(C.jsxs)("div",{children:[n["google.com"]?Object(C.jsxs)(ue.a,{color:"green",closable:!0,onClose:function(){s("google.com")},children:[Object(C.jsx)(p.a,{icon:"google"})," Connected"]}):Object(C.jsx)("div",{className:"mt-2",children:Object(C.jsxs)(x.a,{block:!0,color:"green",onClick:function(){i(new u.a.auth.GoogleAuthProvider)},children:[Object(C.jsx)(p.a,{icon:"google"})," Link to Google"]})}),n["facebook.com"]?Object(C.jsxs)(ue.a,{color:"blue",closable:!0,onClose:function(){s("facebook.com")},children:[Object(C.jsx)(p.a,{icon:"facebook"})," Connected"]}):Object(C.jsx)("div",{className:"mt-2",children:Object(C.jsxs)(x.a,{block:!0,color:"blue",onClick:function(){i(new u.a.auth.FacebookAuthProvider)},children:[Object(C.jsx)(p.a,{icon:"facebook"})," Link to facebook"]})})]})},be=function(e){var t=e.onSignOut,n=K().profile,c=function(){var e=Object(j.a)(l.a.mark((function e(t){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z(n.uid,"name",t,k);case 3:return c=e.sent,e.next=6,k.ref().update(c);case 6:d.a.success("Nickname has been updated",4e3),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),d.a.error(e.t0.message,4e3);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(V.a.Header,{children:Object(C.jsx)(V.a.Title,{children:"Dashboard"})}),Object(C.jsxs)(V.a.Body,{children:[Object(C.jsxs)("h3",{children:["Hey, ",n.name]}),Object(C.jsx)(de,{}),Object(C.jsx)("hr",{}),Object(C.jsx)(je,{name:"Nickname",initialValue:n.name,onSave:c,label:Object(C.jsx)("h6",{className:"mb-2",children:"Nickname"})}),Object(C.jsx)(se,{})]}),Object(C.jsx)(V.a.Footer,{children:Object(C.jsx)(x.a,{block:!0,color:"red",onClick:t,children:"Sign Out"})})]})},he=function(){var e=B(),t=e.isOpen,n=e.close,a=e.open,r=H("(max-width: 992px)"),s=Object(c.useCallback)((function(){k.ref("status/".concat(g.currentUser.uid)).set(W).then((function(){g.signOut(),d.a.info("Signed out",4e3),n()})).catch((function(e){d.a.error(e.message,4e3)}))}),[n]);return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsxs)(x.a,{block:!0,color:"blue",onClick:a,children:[Object(C.jsx)(p.a,{icon:"dashboard"})," DashBoard"]}),Object(C.jsx)(V.a,{full:r,show:t,onHide:n,placement:"left",children:Object(C.jsx)(be,{onSignOut:s})})]})},Oe=n(375),fe=n(389),me=Object(c.createContext)(),xe=function(e){var t=e.children,n=Object(c.useState)(null),a=Object(y.a)(n,2),r=a[0],s=a[1];return Object(c.useEffect)((function(){var e=k.ref("rooms");return e.on("value",(function(e){var t=Y(e.val());s(t)})),function(){e.off()}}),[]),Object(C.jsx)(me.Provider,{value:r,children:t})},pe=function(){return Object(c.useContext)(me)},ve=n(89),ge=function(e){var t=e.room,n=t.createdAt,c=t.name,a=t.lastMessage;return Object(C.jsxs)("div",{children:[Object(C.jsxs)("div",{className:"d-flex justify-content-between align-items-center ",children:[Object(C.jsx)("h3",{className:"text-disappear",children:c}),Object(C.jsx)(ve.a,{datetime:a?new Date(a.createdAt):new Date(n),className:"font-normal text-black-45"})]}),Object(C.jsx)("div",{className:"d-flex align-items-center text-black-70",children:a?Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)("div",{className:"d-flex align-item-center",children:Object(C.jsx)(ce,{src:a.author.avatar,name:a.author.name,size:"sm"})}),Object(C.jsxs)("div",{className:"text-disappear ml-2",children:[Object(C.jsxs)("div",{className:"italic",children:[a.author.name," :"," "]}),Object(C.jsx)("span",{className:"text-black",children:a.text})]})]}):Object(C.jsx)("span",{children:"No messages yet..."})})]})},ke=function(e){var t=e.aboveElHeight,n=pe(),c=Object(i.g)();return Object(C.jsxs)(Oe.a,{appearance:"subtle",vertical:!0,reversed:!0,className:"overflow-y-scroll custom-scroll",style:{height:"calc(100% - ".concat(t,"px)")},activeKey:c.pathname,children:[!n&&Object(C.jsx)(fe.a,{center:!0,vertical:!0,content:"Loading",speed:"slow",size:"md"}),n&&n.length>0&&n.map((function(e){return Object(C.jsx)(Oe.a.Item,{componentClass:s.b,to:"/chat/".concat(e.id),eventKey:"/chat/".concat(e.id),children:Object(C.jsx)(ge,{room:e})},e.id)}))]})},we=function(){var e=Object(c.useRef)(),t=Object(c.useState)(0),n=Object(y.a)(t,2),a=n[0],r=n[1];return Object(c.useEffect)((function(){e.current&&r(e.current.scrollHeight)}),[e]),Object(C.jsxs)("div",{className:"h-100 pt-2",children:[Object(C.jsxs)("div",{ref:e,children:[Object(C.jsx)(he,{}),Object(C.jsx)(z,{}),Object(C.jsx)(S.a,{children:"Join Conversation"})]}),Object(C.jsx)(ke,{aboveElHeight:a})]})};function Ce(e,t){return{roomId:t,author:Object(E.a)({name:e.name,uid:e.uid,createdAt:e.createdAt},e.avatar?{avatar:e.avatar}:{}),createdAt:u.a.database.ServerValue.TIMESTAMP}}var Ne=function(){var e=Object(c.useState)(""),t=Object(y.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(!1),s=Object(y.a)(r,2),o=s[0],u=s[1],b=Object(i.h)().chatId,h=K().profile,O=Object(c.useCallback)((function(e){a(e)}),[]),f=function(){var e=Object(j.a)(l.a.mark((function e(){var t,c,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==n.trim){e.next=2;break}return e.abrupt("return");case 2:return(t=Ce(h,b)).text=n,c={},r=k.ref("messages").push().key,c["/messages/".concat(r)]=t,c["/rooms/".concat(b,"/lastMessage")]=Object(E.a)(Object(E.a)({},t),{},{msgId:r}),u(!0),e.prev=9,e.next=12,k.ref().update(c);case 12:a(""),u(!1),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(9),u(!1),d.a.error(e.t0.message,4e3);case 20:case"end":return e.stop()}}),e,null,[[9,16]])})));return function(){return e.apply(this,arguments)}}();return Object(C.jsx)("div",{children:Object(C.jsxs)(ie.a,{children:[Object(C.jsx)(oe.a,{placeholder:"Write a new Message here",value:n,onChange:O,onKeyDown:function(e){13===e.keyCode&&(e.preventDefault(),f())}}),Object(C.jsx)(ie.a.Button,{color:"blue",appearance:"primary",onClick:f,disabled:o,children:Object(C.jsx)(p.a,{icon:"send"})})]})})},ye=n(134),Se=Object(ye.a)(),Ae=function(e){var t=e.children,n=e.data;return Object(C.jsx)(Se.Provider,{value:n,children:t})},Ee=function(e){return Object(ye.b)(Se,e)},Ie=n(193),Me=n(196),Pe=n(391),De=function(e){if(!e)return"gray";switch(console.log(e),e.state){case"online":return"green";case"offline":default:return"gray"}},Te=function(e){return e?"online"===e.state?"Online":"Last Online ".concat(new Date(e.last_changed).toLocaleDateString()):"unknown State"},Le=function(e){var t=function(e){var t=Object(c.useState)(null),n=Object(y.a)(t,2),a=n[0],r=n[1];return Object(c.useEffect)((function(){var t=k.ref("/status/".concat(e));return t.on("value",(function(e){if(e.exists()){var t=e.val();r(t)}})),function(){t.off()}}),[e]),a}(e.uid);return Object(C.jsx)("div",{children:Object(C.jsx)(Ie.a,{placement:"top",trigger:"hover",speaker:Object(C.jsx)(Me.a,{children:Object(C.jsx)("i",{children:Te(t)})}),children:Object(C.jsx)(Pe.a,{className:"cursor-pointer",style:{backgroundColor:De(t)}})})})},Be=["profile","children"],He=function(e){var t=e.profile,n=e.children,c=Object(ee.a)(e,Be),a=B(),r=a.isOpen,s=a.open,i=a.close,o=t.name,l=t.avatar,j=t.createdAt,u=new Date(j).toLocaleDateString();return Object(C.jsxs)("div",{children:[Object(C.jsx)(x.a,Object(E.a)(Object(E.a)({},c),{},{onClick:s,children:o})),Object(C.jsxs)(M.a,{show:r,onHide:i,children:[Object(C.jsx)(M.a.Header,{children:Object(C.jsxs)(M.a.Title,{children:[o," Profile"]})}),Object(C.jsxs)(M.a.Body,{className:"text-center",children:[Object(C.jsx)(ce,{src:l,name:o,className:"width-200 height-200 img-fullsize font-huge"}),Object(C.jsx)("h4",{className:"mt-2",children:o}),Object(C.jsxs)("p",{children:["Memeber since ",u]})]}),Object(C.jsxs)(M.a.Footer,{children:[n,Object(C.jsx)(x.a,{block:!0,onClick:i,children:"Close"})]})]})]})},Ue=function(e){var t=e.message,n=e.handleAdmin,a=t.author,r=t.createdAt,s=t.text,i=function(){var e=Object(c.useState)(!1),t=Object(y.a)(e,2),n=t[0],a=t[1],r=Object(c.useRef)(null),s=function(){return a(!0)},i=function(){return a(!1)};return Object(c.useEffect)((function(){var e=r.current;return e&&(e.addEventListener("mouseover",s),e.addEventListener("mouseout",i)),function(){e.removeEventListener("mouseover",s),e.removeEventListener("mouseout",i)}}),[r.current]),[r,n]}(),o=Object(y.a)(i,2),l=o[0],j=o[1],u=Ee((function(e){return e.isAdmin})),d=Ee((function(e){return e.admins})).includes(a.uid),b=g.currentUser.uid===a.uid,h=u&&!b;return Object(C.jsxs)("li",{className:"padded mb-1 cursor-pointer ".concat(j?"bg-black-02":""," "),ref:l,children:[Object(C.jsxs)("div",{className:"d-flex align-items-center font-bolder mb-1",children:[Object(C.jsx)(Le,{uid:a.uid}),Object(C.jsx)(ce,{src:a.avatar,name:a.name,className:"ml-1",size:"xs"}),Object(C.jsx)(He,{profile:a,appearance:"link",className:"ml-1 p-0 text-black",children:h&&Object(C.jsx)(x.a,{block:!0,onClick:function(){return n(a.uid)},color:"blue",children:d?"Remove Admin Permission":"Give Admin Permission"})}),Object(C.jsx)(ve.a,{datetime:r,className:"font-normal text-black-45 ml-2"})]}),Object(C.jsx)("div",{children:Object(C.jsx)("span",{className:"word-break-all",children:s})})]})},Fe=Object(c.memo)(Ue),Re=function(){var e,t=Object(i.h)().chatId,n=Object(c.useState)(null),a=Object(y.a)(n,2),r=a[0],s=a[1],o=r&&0===r.length,u=r&&r.length>0;Object(c.useEffect)((function(){var e=k.ref("/messages");return e.orderByChild("roomId").equalTo(t).on("value",(function(e){var t=Y(e.val());s(t)})),function(){e.off("value")}}),[t]);var b=Object(c.useCallback)(function(){var n=Object(j.a)(l.a.mark((function n(c){var a;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=k.ref("rooms/".concat(t,"/admins")),n.next=3,a.transaction((function(t){return t&&(t[c]?(t=null,e="Admin Permission removed"):(t[c]=!0,e="Admin Permission granted")),t}));case 3:d.a.info(e,4e3);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[t]);return Object(C.jsxs)("ul",{className:"msg-list custom-scroll",children:[o&&Object(C.jsx)("li",{children:"No messages yet"}),u&&r.map((function(e){return Object(C.jsx)(Fe,{message:e,handleAdmin:b},e.id)}))]})},ze=n(392),Ve=function(){var e=B(),t=e.isOpen,n=e.open,c=e.close,a=Object(i.h)().chatId,r=H("(max-width : 992px)"),s=Ee((function(e){return e.name})),o=Ee((function(e){return e.description})),l=function(e,t){k.ref("rooms/".concat(a)).child(e).set(t).then((function(){d.a.success("Successfully Updated",4e3)})).catch((function(e){d.a.error(e.message,4e3)}))};return Object(C.jsxs)("div",{children:[Object(C.jsx)(x.a,{className:"br-circle",size:"sm",color:"red",onClick:n,children:"A"}),Object(C.jsxs)(V.a,{full:r,show:t,onHide:c,children:[Object(C.jsx)(V.a.Header,{children:Object(C.jsx)(V.a.Title,{children:"Edit Room"})}),Object(C.jsxs)(V.a.Body,{children:[Object(C.jsx)(je,{initialValue:s,onSave:function(e){l("name",e)},label:Object(C.jsx)("h6",{className:"mb-2",children:"Name"}),emptyMsg:"Name cannot be empty "}),Object(C.jsx)(je,{componentClass:"textarea",rows:5,initialValue:o,onSave:function(e){l("description",e)},label:Object(C.jsx)("h6",{className:"mb-2",children:"Description"}),emptyMsg:"Description cannot be empty ",wrapperClassName:"mt-3"})]}),Object(C.jsx)(V.a.Footer,{children:Object(C.jsx)(x.a,{block:!0,onClick:c,children:"Close"})})]})]})},We=Object(c.memo)(Ve),Ge=function(){var e=B(),t=e.isOpen,n=e.open,c=e.close,a=Ee((function(e){return e.description})),r=Ee((function(e){return e.name}));return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(x.a,{appearance:"link",className:"px-0",onClick:n,children:"Room Information"}),Object(C.jsxs)(M.a,{show:t,onHide:c,children:[Object(C.jsx)(M.a.Header,{children:Object(C.jsxs)(M.a.Title,{children:["About ",r]})}),Object(C.jsxs)(M.a.Body,{children:[Object(C.jsx)("h6",{className:"mb-1",children:"Description "}),Object(C.jsx)("p",{children:a})]}),Object(C.jsx)(M.a.Footer,{children:Object(C.jsx)(x.a,{block:!0,onClick:c,children:"Close"})})]})]})},qe=Object(c.memo)(Ge),Je=function(){var e=Ee((function(e){return e.name})),t=Ee((function(e){return e.isAdmin})),n=H("(max-width: 992px)");return Object(C.jsxs)("div",{children:[Object(C.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(C.jsxs)("h4",{className:"text-disappear d-flex align-items-center",children:[Object(C.jsx)(p.a,{componentClass:s.b,to:"/",icon:"arrow-circle-left",size:"2x",className:n?"d-inline-block p-0 mr-2 text-blue link-unstyled":"d-none"}),Object(C.jsx)("span",{className:"text-disappear",children:e})]}),Object(C.jsx)(ze.a,{className:"ws-nowrap",children:t&&Object(C.jsx)(We,{})})]}),Object(C.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(C.jsx)("span",{children:"todo"}),Object(C.jsx)(qe,{})]})]})},Ke=Object(c.memo)(Je),_e=function(){var e=Object(i.h)().chatId,t=pe();if(!t)return Object(C.jsx)(fe.a,{center:!0,vertical:!0,content:"Loading",speed:"slow",size:"md"});var n=t.find((function(t){return t.id===e}));if(!n)return Object(C.jsxs)("h6",{className:"text-center mt-page",children:["Chat ",e," not found"]});var c,a=n.name,r=n.description,s=(c=n.admins)?Object.keys(c):[],o=s.includes(g.currentUser.uid),l={name:a,description:r,admins:s,isAdmin:o};return Object(C.jsxs)(Ae,{data:l,children:[Object(C.jsx)("div",{className:"chat-top",children:Object(C.jsx)(Ke,{})}),Object(C.jsx)("div",{className:"chat-middle",children:Object(C.jsx)(Re,{})}),Object(C.jsx)("div",{className:"chat-bottom",children:Object(C.jsx)(Ne,{})})]})},Ye=function(){var e=H("(min-width : 992px)"),t=Object(i.i)().isExact,n=e||t;return Object(C.jsx)(xe,{children:Object(C.jsx)(h.a,{fluid:!0,className:"h-100",children:Object(C.jsxs)(O.a,{className:"h-100",children:[n&&Object(C.jsx)(f.a,{xs:24,md:8,className:"h-100",children:Object(C.jsx)(we,{})}),Object(C.jsxs)(i.d,{children:[Object(C.jsx)(i.b,{exact:!0,path:"/chat/:chatId",children:Object(C.jsx)(f.a,{xs:24,md:16,className:"h-100",children:Object(C.jsx)(_e,{})})}),Object(C.jsx)(i.b,{children:e&&Object(C.jsx)(f.a,{xs:24,md:16,className:"h-100",children:Object(C.jsx)("h6",{className:"text-center mt-page",children:"Please Select Chat"})})})]})]})})})},Ze=["children"],Qe=function(e){var t=e.children,n=Object(ee.a)(e,Ze),c=K(),a=c.profile,r=c.isLoading;return r&&!a?Object(C.jsx)(b.a,{children:Object(C.jsx)(fe.a,{center:!0,vertical:!0,size:"md",content:"Loading",speed:"slow"})}):a||r?Object(C.jsx)(i.b,Object(E.a)(Object(E.a)({},n),{},{children:t})):Object(C.jsx)(i.a,{to:"/signin"})},Xe=["children"],$e=function(e){var t=e.children,n=Object(ee.a)(e,Xe),c=K(),a=c.profile,r=c.isLoading;return r&&!a?Object(C.jsx)(b.a,{children:Object(C.jsx)(fe.a,{center:!0,vertical:!0,size:"md",content:"Loading",speed:"slow"})}):a&&!r?Object(C.jsx)(i.a,{to:"/"}):Object(C.jsx)(i.b,Object(E.a)(Object(E.a)({},n),{},{children:t}))};var et=function(){return Object(C.jsx)(J,{children:Object(C.jsxs)(i.d,{children:[Object(C.jsx)($e,{path:"/signin",children:Object(C.jsx)(N,{})}),Object(C.jsx)(Qe,{path:"/",children:Object(C.jsx)(Ye,{})})]})})};r.a.render(Object(C.jsx)(s.a,{children:Object(C.jsx)(et,{})}),document.getElementById("root"))}},[[367,1,2]]]);
//# sourceMappingURL=main.c214fbcd.chunk.js.map